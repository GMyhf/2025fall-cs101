import pandas as pd

file_path = '/Users/hfyan/MyPythonApp/studentListInCourse-20250903-ADS.xls'

df = pd.read_excel(file_path)
#df = pd.read_excel('studentListInCourse-20250829.xls')
student_id = df['学号'].tolist()

sent_id = {
    2100013381, 2100013383, 2100014523, 2200013432, 2200013433, 2200013707, 2200014124, 2200015443, 2200015502, 2200017421, 
    2200017737, 2200018112, 2300012281, 2300012303, 2300013424, 2300016613, 2300017745, 2300018507, 2400011424, 2400011731, 
    2400011747, 2400011813, 2400011814, 2400012303, 2400013255, 2400017446, 2400017461, 2400017744, 2400017752, 2400017777, 
    2400017811, 2400017831, 2400091601, 2500010622, 2500010629, 2500010826, 2500010846, 2500010849, 2500010862, 2500010972, 
    2500011005, 2500011072, 2500011111, 2500011113, 2500011126, 2500011175, 2500011176, 2500011178, 2500011305, 2500011309, 
    2500011313, 2500011321, 2500011322, 2500011324, 2500011330, 2500011335, 2500011337, 2500011342, 2500011349, 2500011401, 
    2500011403, 2500011406, 2500011413, 2500011418, 2500011427, 2500011443, 2500011444, 2500011445, 2500011449, 2500011451, 
    2500011452, 2500011456, 2500011459, 2500011461, 2500011463, 2500011464, 2500011469, 2500011475, 2500011476, 2500011482, 
    2500011485, 2500011487, 2500011488, 2500011489, 2500011496, 2500011497, 2500011503, 2500011504, 2500011514, 2500011516, 
    2500011517, 2500011522, 2500011523, 2500011524, 2500011532, 2500011535, 2500011553, 2500011558, 2500011570, 2500011571, 
    2500011573, 2500011583, 2500011584, 2500011587, 2500011588, 2500011593, 2500011595, 2500011619, 2500011653, 2500011702, 
    2500011707, 2500011715, 2500011716, 2500011721, 2500011722, 2500011728, 2500011731, 2500011735, 2500011739, 2500011741, 
    2500011750, 2500011751, 2500011754, 2500011766, 2500011778, 2500011788, 2500011790, 2500011796, 2500011800, 2500011801, 
    2500011802, 2500011809, 2500011810, 2500011811, 2500011812, 2500011816, 2500011817, 2500011823, 2500011851, 2500011856, 
    2500011859, 2500011870, 2500011877, 2500011880, 2500011884, 2500011889, 2500011897, 2500011905, 2500011906, 2500012117, 
    2500012127, 2500012130, 2500012131, 2500012132, 2500012145, 2500012155, 2500012254, 2500012262, 2500012265, 2500012285, 
    2500012317, 2500012506, 2500012552, 2500012555, 2500012614, 2500012618, 2500012657, 2500013309, 2500013545, 2500013607, 
    2500013702, 2500013704, 2500013720, 2500013761, 2500015803, 2500015812, 2500015830, 2500015859, 2500015879, 2500016657, 
    2500017458, 2500017707, 2500094621, 2510122418, 2510122605, 2510122706, 2510122711, 2510122712, 2510122713, 2510122905, 
    2510122907, 2510122908, 2510122916, 2510301120, 2510301201, 2510301344, 2510301365, 2510305127, 2510305208, 2510305211, 
    2510305303, 2510305317, 2510306117, 2510306148, 2510307108, 2510307218, 2510307231, 2510307315, 2510307426, 2500010627, 
    2500010774, 2500010964, 2500010984, 2500011006, 2500011042, 2500011117, 2500011158, 2500011168, 2500011169, 2500011171, 
    2500011306, 2500011312, 2500011346, 2500011491, 2500011511, 2500011552, 2500011575, 2500011617, 2500011705, 2500011719, 
    2500011726, 2500011745, 2500011806, 2500011886, 2500012103, 2500012134, 2500012142, 2500012258, 2500012264, 2500012305, 
    2500012312, 2500012314, 2500012319, 2500012445, 2500012560, 2500012608, 2500012611, 2500012659, 2500013252, 2500013509, 
    2500013564, 2500013572, 2500015448, 2500015815, 2500015848, 2500015889, 2510122516, 2510122619, 2510122621, 2510122709, 
    2510122911, 2510301107, 2510301219, 2510301244, 2510301352, 2510301360, 2510305111, 2510305219, 2510305228, 2510305235, 
    2510306108, 2510306138, 2510306144, 2510306219, 2510307117, 2510307226, 2510307229, 2510307331, 2510307429, 2400011047, 
    2400017731, 2400091603, 2500010607, 2500010819, 2500010839, 2500011033, 2500011110, 2500011152, 2500011172, 2500011183, 
    2500011184, 2500011201, 2500011308, 2500011348, 2500011424, 2500011429, 2500011435, 2500011446, 2500011473, 2500011481, 
    2500011578, 2500011590, 2500011610, 2500011656, 2500011770, 2500011783, 2500012143, 2500012259, 2500012261, 2500012298, 
    2500012566, 2500012605, 2500012610, 2500013314, 2500013525, 2500013577, 2500013582, 2500013768, 2500015836, 2500015852, 
    2500015860, 2500015895, 2500016656, 2500017412, 2500017449, 2500090107, 2510122705, 2510301111, 2510301119, 2510301144, 
    2510301242, 2510301264, 2510305102, 2510305106, 2510305130, 2510305207, 2510305334, 2510306229, 2510306242, 2510307209, 
    2510307408, 2200014183, 2300014558, 2500010974, 2500011010, 2500011021, 2500011121, 2500011173, 2500011177, 2500011190,
    2500011206, 2500011211, 2500011221, 2500011307, 2500011323, 2500011345, 2500011420, 2500011422, 2500011423, 2500011426,
    2500011448, 2500011450, 2500011462, 2500011468, 2500011474, 2500011479, 2500011501, 2500011521, 2500011531, 2500011548,
    2500011559, 2500011564, 2500011569, 2500011605, 2500011609, 2500011612, 2500011729, 2500011756, 2500012108, 2500012111,
    2500012128, 2500012137, 2500012252, 2500012290, 2500012300, 2500012304, 2500012310, 2500012402, 2500012414, 2500012443,
    2500012447, 2500012505, 2500012511, 2500012620, 2500013306, 2500013328, 2500015411, 2500015823, 2500015850, 2500015872,
    2500015899, 2500017463, 2500017709, 2500017719, 2510301228, 2510305104, 2510305227, 2510305331, 2510305332, 2400094601,
    2500011103, 2500011114, 2500011139, 2500011440, 2500011502, 2500011597, 2500011771, 2500011828, 2500012152, 2500012283,
    2500012423, 2500012432, 2500013508, 2500013557, 2500015837, 2500015840, 2500015853, 2500015878, 2500015887, 2500015888,
    2500016617, 2500016633, 2500017402, 2500017425, 2500017479, 2500017706, 2500017732, 2500017743, 2500017782, 2500017806,
    2500017830, 2500018308, 2500090110, 2500091201, 2500092808, 2500098604, 2510301130, 2510301164, 2510301226, 2510301232,
    2510301361, 2510305118, 2510306139, 2510307127, 2200015497, 2500010705, 2500010752, 2500011015, 2500011161, 2500011170,
    2500011336, 2500011439, 2500011454, 2500011472, 2500011495, 2500011506, 2500011782, 2500012106, 2500012159, 2500012257,
    2500012299, 2500012306, 2500012321, 2500012410, 2500012412, 2500012607, 2500012625, 2500013514, 2500013521, 2500013714,
    2500015855, 2500016618, 2500016650, 2500017752, 2500017765, 2500017801, 2500017810, 2500090106, 2500090109, 2500091107,
    2500091601, 2500091605, 2500091610, 2500092603, 2500092701, 2500093008, 2500098605, 2500098607, 2510122701, 2510301138,
    2510301261, 2510305129, 2510306224





}

print(len(sent_id))

res1 = []
res2 = []
for i in student_id:
    if i in sent_id:
        continue

    res2.append(i)
    if i < 2e9:
        res1.append(f"{i}@pku.edu.cn")
    else:
        res1.append(f"{i}@stu.pku.edu.cn")

print(','.join(res1))
print(', '.join(map(str, res2)))

'''
我是mac机器，可以这样发送，但是北大邮箱总把收到的邮件归到Spam里面。
(cat mail.txt; uuencode 20230820-Wechat.jpg 20230820-Wechat.jpg)|mail -s "202308 计算概论（B）（12班）课程微信群" x@pku.edu.cn

所以我现在是程序输出要发送同学的邮箱地址列表，拷贝下来，在浏览器邮件里面发送。
'''
