# 在 VS Code 中写第一个 C++ 程序

*Updated 2025-08-25 18:56 GMT+8*  
 *Compiled by Hongfei Yan (2025 Summer)*    



目标：在macOS 或者 Windows 的 VS Code 上编译、执行和调试 C++ 程序。



# macOS 环境配置

## ✅ 第一步：安装必要工具

### 1. 安装 C++ 编译器（Xcode Command Line Tools）

打开 **终端 Terminal**，输入：

```bash
xcode-select --install
```

会弹出提示窗口，点击安装即可。这会安装 Apple 提供的 `clang++` 编译器，它兼容 `g++` 的使用方式。。

### 2. 安装 VS Code（已安装可跳过）

官网下载安装：https://code.visualstudio.com/

### 3. 安装 VS Code C++ 扩展（一次性操作）

打开 VS Code，按下：

```
Command + Shift + X
```

在扩展市场搜索并安装：

```
C/C++（Microsoft 出品的）
```



## ✅ 第二步：写一个简单的 C++ 程序

### 1. 打开 VS Code，新建一个文件夹作为项目目录

比如目录为：`cd ~/MyCpp  # 替换为你的项目路径`

**在终端打开 VS Code（推荐）**

在终端中执行：

```
code ./
```

这会直接以该目录作为工作区打开 VS Code。

### 2. 创建一个文件 `hello_world.cpp`，内容如下：

```cpp
#include <iostream>
using namespace std;

int main() {
    cout << "Hello, world!" << endl;
    cout << "1" << endl;
    cout << "2" << endl;
    cout << "3" << endl;
    cout << "bye" << endl;
    return 0;
}

```



## ✅ 第三步：编译并运行程序

确保终端当前目录为项目路径，如 `MyCpp`：

```bash
g++ hello_world.cpp -o hello_world
./hello_world
```

输出应该是：

```
Hello, world!
1
2
3
bye
```



## ✅ （可选）第四步：设置 VS Code 的一键构建任务

想要在 VS Code 里按快捷键就编译运行，可以设置 Task：

1. 在项目根目录`~/MyCpp`下创建文件夹 `.vscode`
2. 新建文件 `.vscode/tasks.json`，内容如下：

```json
{
    "version": "2.0.0",
    "tasks": [
        {
            "type": "cppbuild",
            "label": "C/C++: g++ build active file",
            "command": "/usr/bin/g++",
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        }
    ]
}
```



3. 新建文件 `.vscode/launch.json`，内容如下：

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "debug current cpp file",
      "type": "cppdbg",
      "request": "launch",
      "program": "${fileDirname}/${fileBasenameNoExtension}",
      "args": [],
      "stopAtEntry": false,
      "cwd": "${fileDirname}",
      "environment": [],
      "externalConsole": true,
      "MIMode": "lldb"
    }
  ]
}
```

然后按：

```
Command + Shift + B
```

选择：C/C++: g++ build active file 

即可编译。

可以在终端运行以下命令（确保当前目录中有 `hello_world`）：

```bash
./hello_world
```

输出应该是：

```
Hello, world!
1
2
3
bye
```

------

>  `Makefile`目前不需要掌握。
>
> ✅ 提示：如果你要编写多个 C++ 文件、写工程项目？
>
> 可考虑配置更高级的方式，例如：
>
> - 使用 `Makefile`
> - 使用 `CMake`
> - 安装 Code Runner 插件来快速运行简单 C++ 文件



# Windows 环境配置

## ✅ 第一步：安装必要工具

> 特别⚠️：务必记住 GCC 和非ASCII 字符是死敌，因此请不要将 GCC 安装在包含非 ASCII 字符（如汉字、空格）的路径下！（最大的坑可能是你的用户名中包含非 ASCII 字符，例如汉字！）

### 1. 安装 C++ 编译器

在 Windows 下，选择：**MinGW-w64**

1. 打开官网安装包（建议从 MSYS2 下载最新版）：
   https://www.msys2.org/

2. 安装完成后，打开 `MSYS2 MinGW` 终端，执行：

   ```bash
   pacman -Syu
   pacman -S mingw-w64-ucrt-x86_64-gcc
   pacman -S mingw-w64-ucrt-x86_64-gdb
   ```

   > 如果下载软件包时出现的网络错误信息，主要原因不是包有问题，而是网络传输过程中断或超时了。报错主要原因是：
   >
   > - 网络不稳定 / 太慢
   > - 镜像源不通或服务器负载大
   > - Pacman 默认超时比较短
   >
   > ------
   >
   > **解决方法**
   >
   > 可以尝试以下几步：
   >
   > 1. **换镜像源**（推荐）
   >    编辑 `C:\msys64\etc\pacman.d\mirrorlist.msys` 和 `mirrorlist.mingw`，把 `mirror.msys2.org` 换成国内镜像，例如：
   >
   >    - 清华大学：https://mirrors.tuna.tsinghua.edu.cn/msys2/
   >    - 中科大：https://mirrors.ustc.edu.cn/msys2/
   >    - 浙江大学：https://mirrors.zju.edu.cn/msys2/
   >
   >    然后再执行：
   >
   >    ```bash
   >    pacman -Syyu
   >    ```
   >
   > 2. **增加超时时间**
   >    在 pacman 命令中加上选项：
   >
   >    ```bash
   >    pacman -Syu --disable-download-timeout
   >    ```
   >
   >    这样即使速度慢也不会轻易中断。
   >
   > 3. **尝试多次更新**
   >    有时只是临时网络问题，可以重复执行：
   >
   >    ```bash
   >    pacman -Syu
   >    ```
   >
   > 

3. 把 g++ 加到 PATH（让 VS Code 终端能用）
   例如：`C:\msys64\ucrt64\bin`

   > 按下：
   >
   > ```
   > Win + S → 输入 “环境变量” → 打开 “编辑系统环境变量” → 环境变量
   > ```
   >
   > 在 **系统变量** 里找到 `Path` → 编辑 → 新建 → 粘贴上面的路径 → 确定保存。
   >
   > 关闭 VS Code，重新打开，让新 PATH 生效。

4. 检查是否安装成功

   在 VS Code 终端（PowerShell 或 CMD）里输入：

   ```
   g++ --version
   ```

   如果能显示版本号，说明安装成功。



### 2. 安装 VS Code（已安装可跳过）

下载地址：https://code.visualstudio.com/

------

### 3. 安装 VS Code C++ 扩展（一次性操作）

打开 VS Code，按下：

```
Ctrl + Shift + X
```

在扩展市场搜索并安装：

```
C/C++（Microsoft 出品的）
```



## ✅ 第二步：写一个简单的 C++ 程序

### 1. 新建项目文件夹

例如：`D:\MyCpp`

在 **PowerShell 或 CMD** 中执行：

```powershell
code D:\MyCpp
```

这会直接以该目录作为工作区打开 VS Code。

------

### 2. 创建 `hello_world.cpp`

内容如下：

```cpp
#include <iostream>
using namespace std;

int main() {
    cout << "Hello, world!" << endl;
    cout << "1" << endl;
    cout << "2" << endl;
    cout << "3" << endl;
    cout << "bye" << endl;
    return 0;
}
```



## ✅ 第三步：编译并运行程序

确保终端当前目录为项目路径，例如：

```powershell
cd D:\MyCpp
```

编译：

```powershell
g++ hello_world.cpp -o hello_world.exe
```

> 如果编译报错
>
> ```powershell
> PS D:\MyCpp> g++ hello_world.cpp -o hello_world.exe
> Assembler messages:
> Fatal error: can't create C:\Users\
> PS D:\MyCpp>
> ```
>
> **用户名包含汉字很可能是导致你遇到 `g++` 编译错误的主要原因**。
>
> 虽然现代操作系统和许多软件已经对 Unicode（包括中文）有了较好的支持，但**一些较老的、或基于特定工具链的软件（尤其是某些版本的 MinGW-w64 / g++）在处理包含非 ASCII 字符（如中文、空格、特殊符号）的路径时，仍然存在兼容性问题**。
>
> **为什么用户名含汉字会导致问题？**
>
> 1. **临时文件路径**：`g++` 在编译过程中会创建临时文件。这些临时文件通常会存放在系统的临时目录中，比如 `C:\Users\<你的用户名>\AppData\Local\Temp\`。如果用户名是中文，这个路径就包含了中文字符。
> 2. **工具链解析错误**：`g++` 本身或其依赖的底层工具（如 `as` 汇编器、`ld` 链接器）可能无法正确解析或处理包含中文字符的路径名，导致“无法创建文件”或“路径不存在”的错误，即使路径在文件资源管理器中是可见的。
> 3. **编码问题**：命令行环境（CMD 或 PowerShell）与编译器之间可能存在字符编码（如 ANSI vs UTF-8）的不匹配，导致路径被错误地解释。
>
> **✅ 解决方法：更改系统的临时目录（推荐，无需改用户名）**
>
> 这是最安全、最直接的解决方案，无需更改你的 Windows 用户名。
>
> 1. **打开系统环境变量设置**：
>
>    - 右键点击“此电脑”或“我的电脑” -> “属性”。
>    - 点击“高级系统设置”。
>    - 在“系统属性”窗口中，点击“环境变量”按钮。
>
> 2. **修改临时目录变量**：
>
>    - 在“用户变量”或“系统变量”中找到 `TEMP` 和 `TMP`。
>
>    - 将它们的值从类似 `C:\Users\你的中文用户名\AppData\Local\Temp` 修改为一个不包含中文和空格的路径
>
>      ，例如：`C:\Temp`
>
>    - **重要**：你需要先手动创建这个新文件夹（如 `C:\Temp`），并确保你有读写权限。
>
> 3. **验证更改**
>
>    完成上述步骤后，重新打开一个新的 PowerShell 或 CMD 窗口，验证环境变量是否已更改：
>
>    ```powershell
>    echo $env:TEMP
>    echo $env:TMP
>    ```
>
>    你应该能看到输出为 `C:\Temp`。
>
> 4. **重启命令行**：
>
>    - 关闭所有已打开的 CMD 或 PowerShell 窗口，然后重新打开一个新的窗口。
>
>    - 再次尝试运行你的 `g++`命令：
>
>      ```
>      g++ hello_world.cpp -o hello_world.exe
>      ```
>
> #### 

运行：

```powershell
.\hello_world.exe
```

输出应该是：

```
Hello, world!
1
2
3
bye
```



## ✅ （可选）第四步：VS Code 一键编译运行

1. 在项目根目录 `D:\MyCpp` 下创建 `.vscode` 文件夹
2. 新建 `.vscode\tasks.json`：

```json
{
    "version": "2.0.0",
    "tasks": [
        {
            "type": "cppbuild",
            "label": "C/C++: g++ build active file",
            "command": "g++",
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}",
                "-o",
                "${fileDirname}\\${fileBasenameNoExtension}.exe"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated for Windows g++."
        }
    ]
}
```

1. 新建 `.vscode\launch.json`：

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "debug current cpp file",
      "type": "cppdbg",
      "request": "launch",
      "program": "${fileDirname}\\${fileBasenameNoExtension}.exe",
      "args": [],
      "stopAtEntry": false,
      "cwd": "${fileDirname}",
      "environment": [],
      "externalConsole": true,
      "MIMode": "gdb",
      "miDebuggerPath": "gdb"
    }
  ]
}
```

1. 在 VS Code 按：

```
Ctrl + Shift + B
```

选择 **C/C++: g++ build active file**
即可编译。

运行则直接：

```powershell
.\hello_world.exe
```

